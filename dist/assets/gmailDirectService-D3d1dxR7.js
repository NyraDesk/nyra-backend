import{g as c}from"./index-Dh14THqw.js";const l={async sendEmail(o){const t=localStorage.getItem("access_token")||localStorage.getItem("gmail_access_token")||localStorage.getItem("google_access_token");if(console.log("Gmail: Token status:",t?"found":"not found"),!t)throw new Error("Token Gmail non trovato. Effettua il login con Google.");const r=[`To: ${o.email||o.to}`,`Subject: ${o.subject||"Messaggio da NYRA"}`,"",o.body||o.suggestedBody||""].join(`\r
`),s=btoa(unescape(encodeURIComponent(r))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),e=await fetch(c("/users/me/messages/send"),{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({raw:s})});if(!e.ok){const a=await e.text();throw console.error("Errore Gmail API:",a),new Error(`Invio email fallito: ${e.status}`)}const n=await e.json();return console.log("âœ… Email inviata via Gmail:",n),n}};export{l as gmailDirectService};
